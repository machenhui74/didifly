# 小马达儿童视觉训练方案生成系统

## 项目简介

小马达儿童视觉训练方案生成系统是一款专为儿童视觉能力测评和训练设计的软件工具。系统基于儿童的基本信息和视觉能力测评数据，自动生成个性化的训练方案和详细的测评报告，为儿童视觉能力发展提供科学指导。

## 主要功能

- **基本信息采集**：记录儿童姓名、出生日期、测评日期等个人信息
- **测评机构信息**：记录训练中心和测评师信息
- **视觉能力测评**：包含四项核心测评指标
  - 视觉广度测试：评估儿童同时处理多个视觉信息的能力
  - 视觉辨别测试：评估儿童区分相似视觉图形的能力
  - 视动统合测试：评估儿童眼手协调能力
  - 视觉记忆测试：评估儿童短期视觉记忆能力
- **自动评级分析**：根据年龄和测评数据，自动计算能力等级和进步目标
- **训练方案生成**：生成个性化的训练方案，保存至指定目录
- **测评报告导出**：生成专业的测评报告，详细记录测评结果和发展建议

## 系统架构

系统由以下几个核心模块组成：

- **GUI模块** (`gui.py`)：提供友好的图形用户界面，采集数据并调用其他模块
  - 基于tkinter和ttkbootstrap构建现代化界面
  - 采用选项卡设计，分离基本信息和测评数据
  - 内置日期选择器和输入验证功能
  - 提供友好的用户反馈和进度指示

- **训练方案生成器** (`plan_generator.py`)：根据测评结果生成个性化训练方案
  - 基于评级计算难度适配的训练内容
  - 按能力权重分配不同类型的训练任务
  - 自动组织训练内容为12节课程
  - 从训练素材库中随机选取合适难度的训练文件

- **报告生成器** (`baogao4.py`)：生成测评报告文档
  - 使用DocxTemplate模板系统生成Word格式报告
  - 自动填充测评数据和分析结果
  - 保存报告至指定文件夹结构

- **目标计算器** (`target_calculator.py`)：计算能力评级和下阶段训练目标
  - 根据年龄和测评分数划分能力等级（极差/不合格/合格/优秀）
  - 自动计算下阶段合理训练目标
  - 针对不同年龄段提供不同的评级标准

## 评级标准说明

系统根据儿童年龄和测评数据，将视觉能力分为四个等级：

- **优秀**：超过同龄儿童平均水平
- **合格**：达到同龄儿童平均水平
- **不合格**：低于同龄儿童平均水平
- **极差**：显著低于同龄儿童平均水平

各项测试的具体评级标准如下：

1. **视觉广度**：
   - 7岁以上：优秀（0-119秒）、合格（120-180秒）、不合格（181-300秒）、极差（301秒以上）
   - 7岁以下：优秀（0-179秒）、合格（180-240秒）、不合格（241-360秒）、极差（361秒以上）

2. **视觉辨别**：
   - 所有年龄段：优秀（0-2个）、合格（3-4个）、不合格（5-8个）、极差（9个以上）

3. **视动统合**：
   - 年龄不同标准不同，如7岁：优秀（18+分）、合格（16-17分）、不合格（14-15分）、极差（0-13分）

4. **视觉记忆**：
   - 所有年龄段：优秀（4分）、合格（3分）、不合格（2分）、极差（0-1分）

## 软件依赖

- Python 3.12+
- tkinter (Python标准库GUI组件)
- ttkbootstrap (美化界面)
- docxtpl 0.16.7+ (文档模板引擎)
- datetime, os, re, random, shutil (Python标准库)

### 安装指南

1. 安装Python 3.12或更高版本
2. 安装所需第三方库：

```powershell
pip install ttkbootstrap
pip install docxtpl
```

## 使用方法

1. **启动系统**
   ```
   python cpbg/gui.py
   ```

2. **填写基本信息**
   - 输入儿童姓名、出生日期和测评日期
   - 填写测评机构和测评师信息

3. **录入测评数据**
   - 切换至"测评数据"选项卡
   - 输入四项视觉能力测评的原始数据

4. **生成方案和报告**
   - 点击"生成训练方案"按钮
   - 系统自动计算评级并生成方案和报告
   - 训练方案将保存至`D:\学员训练方案`目录

## 文件结构

系统生成的文件结构如下：

- 训练方案：`D:\学员训练方案\{儿童姓名}—12节课视觉训练\第{1-12}次课\`
- 测评报告：`D:\备课系统\测评报告\{儿童姓名}测评记录\{儿童姓名}_{测评日期}_测评报告.docx`

## 注意事项

- 系统默认数据源文件夹为：`D:\23`
- 系统默认输出文件夹为：`D:\学员训练方案`
- 测评报告输出文件夹为：`D:\备课系统\测评报告`
- 测评报告模板位置：`D:\备课系统\测试测评\测试报告.docx`
- 如需修改默认路径，请在相应文件中修改路径变量

## 界面预览

系统采用现代化设计，使用ttkbootstrap美化，主题为"litera"，界面友好直观。

## 开发者信息

本系统由小马达儿童能力训练中心开发，用于儿童视觉能力测评和训练方案生成。 