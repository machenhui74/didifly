{% extends 'base.html' %}

{% block title %}登录 - 儿童学习能力评估与训练系统{% endblock %}

{% block head_extra %}
<style>
  :root {
    --tiffany-blue: #0ABAB5;
    --tiffany-blue-dark: #089A94;
    --tiffany-blue-light: #E0F7FA;
    --tiffany-blue-xlight: #F0FDFF;
    --text-color-dark: #333;
    --text-color-light: #f8f9fa;
    --gray-100: #f8f9fa;
    --gray-200: #e9ecef;
    --gray-300: #dee2e6;
    --gray-400: #ced4da;
    --gray-600: #6c757d;
    --white: #fff;
    --box-shadow-sm: 0 .125rem .25rem rgba(0,0,0,.075);
    --box-shadow-md: 0 .5rem 1rem rgba(0,0,0,.1);
    --box-shadow-lg: 0 1rem 3rem rgba(0,0,0,.15);
    --border-radius-sm: .25rem;
    --border-radius-md: .5rem;
    --border-radius-lg: 1rem;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background: linear-gradient(135deg, var(--tiffany-blue-xlight) 0%, var(--tiffany-blue-light) 100%);
    margin: 0;
    overflow-x: hidden;
    color: var(--text-color-dark);
  }

  .login-page-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 20px;
    position: relative; /* For background bubbles */
  }

  .background-bubbles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 0;
  }

  .bubble {
    position: absolute;
    background-color: rgba(10, 171, 181, 0.1); /* Light Tiffany Blue bubbles */
    border-radius: 50%;
    animation: bubble-rise 20s infinite ease-in-out;
    opacity: 0;
  }

  @keyframes bubble-rise {
    0% {
      transform: translateY(0) scale(0.5);
      opacity: 0;
    }
    50% {
      opacity: 0.7;
    }
    90% {
      opacity: 0.3;
    }
    100% {
      transform: translateY(-100vh) scale(1.2);
      opacity: 0;
    }
  }

  .login-container-new {
    display: flex;
    width: 100%;
    max-width: 960px; /* 调整容器宽度 */
    background-color: var(--white);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--box-shadow-lg);
    overflow: hidden;
    z-index: 1;
    animation: fadeIn 0.8s ease-out;
    position: relative; /* 确保相对于页面定位 */
    top: -2vh; /* 稍微上移，使卡片更居中 */
  }

  .login-left-panel {
    flex: 1;
    padding: 60px 40px; /* 增加上下内边距 */
    background-color: var(--tiffany-blue); /* Tiffany Blue background for left panel */
    color: var(--white);
    display: flex;
    flex-direction: column;
    justify-content: center;
    animation: fadeInLeft 1s ease-out 0.2s both;
  }

  .login-left-panel .system-name-new {
    font-size: 2.2rem;
    font-weight: 600;
    margin-bottom: 15px;
  }

  .login-left-panel .system-description-new {
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 30px;
    opacity: 0.9;
  }

  .feature-list-new {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .feature-item-new {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    font-size: 0.95rem;
  }

  .feature-item-new .icon {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.2);
    color: var(--white);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    font-weight: bold;
  }

  .login-right-panel {
    flex-basis: 400px; /* 固定右侧宽度 */
    padding: 60px 40px; /* 增加上下内边距 */
    display: flex;
    flex-direction: column;
    justify-content: center;
    animation: slideInRight 1s ease-out 0.2s both;
  }

  .login-title-new {
    font-size: 1.8rem;
    font-weight: 600;
    color: var(--tiffany-blue);
    margin-bottom: 30px;
    text-align: center;
  }

  /* Bootstrap 5 inspired floating labels */
  .form-floating {
    position: relative;
    margin-bottom: 1.5rem; /* 增加间距 */
  }

  .form-floating > .form-control-new {
    padding: 1rem 0.75rem;
    height: auto; /* 确保padding生效 */
    border: 1px solid var(--gray-300);
    border-radius: var(--border-radius-md);
    transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
  }

  .form-floating > label {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%; 
    padding: 1rem 0.75rem;
    pointer-events: none;
    border: 1px solid transparent;
    transform-origin: 0 0;
    transition: opacity .1s ease-in-out, transform .1s ease-in-out;
    color: var(--gray-600);
    font-size: 1rem;
  }

  .form-floating > .form-control-new::placeholder {
    color: transparent;
  }

  .form-floating > .form-control-new:focus,
  .form-floating > .form-control-new:not(:placeholder-shown) {
    padding-top: 1.625rem;
    padding-bottom: .625rem;
  }
  
  .form-floating > .form-control-new:focus {
      border-color: var(--tiffany-blue);
      box-shadow: 0 0 0 0.2rem rgba(10, 171, 181, 0.25);
  }

  .form-floating > .form-control-new:focus ~ label,
  .form-floating > .form-control-new:not(:placeholder-shown) ~ label {
    opacity: .75;
    transform: scale(.85) translateY(-.6rem) translateX(.15rem); /* 调整标签动画效果 */
    background-color: var(--white); /* 确保标签背景为白色，遮挡输入框边框 */
    padding: 0 .25rem; /* 给标签左右一点padding */
    height: auto; /* 调整高度以适应缩小的字体 */
    border: none; /* 移除label的边框 */
  }
  
  .form-control-new {
    display: block;
    width: 100%;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    color: var(--text-color-dark);
    background-color: var(--white);
    background-clip: padding-box;
    appearance: none; /* For custom select styling if needed */
  }


  .btn-tiffany {
    background-color: var(--tiffany-blue);
    border: none;
    color: white;
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    font-weight: 500;
    border-radius: var(--border-radius-md);
    transition: background-color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    width: 100%; /* 按钮宽度充满容器 */
  }

  .btn-tiffany:hover {
    background-color: var(--tiffany-blue-dark);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    transform: translateY(-2px);
  }

  .btn-tiffany:active {
    background-color: var(--tiffany-blue-dark);
    transform: translateY(1px); /* 3D按压效果 */
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
  }

  .alert-new {
    padding: 1rem;
    margin-bottom: 1rem;
    border: 1px solid transparent;
    border-radius: var(--border-radius-sm);
    width: 100%;
    box-sizing: border-box; /* 确保padding不影响宽度 */
    font-size: 0.9rem;
  }

  .alert-danger-new {
    color: #721c24;
    background-color: #f8d7da;
    border-color: #f5c6cb;
  }
  .alert-success-new {
    color: #155724;
    background-color: #d4edda;
    border-color: #c3e6cb;
  }
  /* 其他 alert 类型可以按需添加 */


  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes fadeInLeft {
    from { opacity: 0; transform: translateX(-30px); }
    to { opacity: 1; transform: translateX(0); }
  }

  @keyframes slideInRight {
    from { opacity: 0; transform: translateX(30px); }
    to { opacity: 1; transform: translateX(0); }
  }

  /* 响应式设计 */
  @media (max-width: 768px) {
    .login-container-new {
      flex-direction: column;
      max-width: 400px; /* 移动设备上内容区最大宽度 */
    }
    .login-left-panel {
      display: none; /* 在小屏幕上隐藏左侧面板 */
    }
    .login-right-panel {
      flex-basis: auto; /* 恢复自动高度 */
      padding: 40px 25px; /* 调整内边距 */
    }
    .login-title-new {
        font-size: 1.6rem;
        margin-bottom: 25px;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="login-page-wrapper">
    <div id="background-bubbles" class="background-bubbles"></div>
    <div class="login-container-new">
        <div class="login-left-panel">
            <div class="system-name-new">儿童学习能力评估系统</div>
            <div class="system-description-new">
                专业的儿童学习能力评估与训练方案生成工具。我们致力于提供科学、个性化的方案，助力孩子健康成长。
            </div>
            <ul class="feature-list-new">
                <li class="feature-item-new">
                    <span class="icon">✓</span>
                    <span>科学评估儿童视觉能力</span>
                </li>
                <li class="feature-item-new">
                    <span class="icon">✓</span>
                    <span>针对性个性化训练方案</span>
                </li>
                <li class="feature-item-new">
                    <span class="icon">✓</span>
                    <span>专业的测评报告生成</span>
                </li>
                <li class="feature-item-new">
                    <span class="icon">✓</span>
                    <span>跟踪训练进度与效果</span>
                </li>
            </ul>
        </div>
        <div class="login-right-panel">
            <div class="login-title-new">账号登录</div>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert-new alert-{{ category if category != 'error' else 'danger' }}-new">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <form method="POST" action="{{ url_for('auth.login') }}" style="width: 100%;">
                {{ form.hidden_tag() }}
                <div class="form-floating">
                    <input type="text" class="form-control-new" id="username" name="username" placeholder="账号" required>
                    <label for="username">账号</label>
                </div>
                <div class="form-floating">
                    <input type="password" class="form-control-new" id="password" name="password" placeholder="密码" required>
                    <label for="password">密码</label>
                </div>
                <button type="submit" class="btn-tiffany">登 录</button>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const bubblesContainer = document.getElementById('background-bubbles');
    if (bubblesContainer) {
        const bubbleCount = 10; // 减少气泡数量，使其更微妙

        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            
            const size = Math.random() * 30 + 10; // 较小的气泡
            bubble.style.width = size + 'px';
            bubble.style.height = size + 'px';
            
            bubble.style.left = Math.random() * 100 + '%';
            bubble.style.bottom = '-' + size + 'px'; // 从底部开始

            const animationDuration = Math.random() * 15 + 10; // 动画持续时间 (10-25s)
            const animationDelay = Math.random() * 5; // 动画延迟 (0-5s)
            
            bubble.style.animationDuration = animationDuration + 's';
            bubble.style.animationDelay = animationDelay + 's';
            
            bubblesContainer.appendChild(bubble);
            
            // 气泡动画结束后移除，防止 DOM 元素过多
            setTimeout(() => {
                if (bubble.parentNode) {
                    bubble.parentNode.removeChild(bubble);
                }
            }, (animationDuration + animationDelay + 1) * 1000);
        }

        for (let i = 0; i < bubbleCount; i++) {
            createBubble();
        }
        // 可以选择性地定时创建新气泡，如果需要持续效果
        // setInterval(createBubble, 5000); // 例如每5秒创建一个
    }
});
</script>
{% endblock %} 